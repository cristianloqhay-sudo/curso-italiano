<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>L√©xico Italiano Interattivo - Tu Gu√≠a Diaria</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/3.9.1/chart.min.js"></script>
    <style>
        /* Custom Font Imports if needed, using system fonts for performance */
        body { font-family: 'Segoe UI', Roboto, Helvetica, Arial, sans-serif; }
        
        /* Card Flip Animation */
        .perspective-1000 { perspective: 1000px; }
        .transform-style-3d { transform-style: preserve-3d; }
        .backface-hidden { backface-visibility: hidden; }
        .rotate-y-180 { transform: rotateY(180deg); }
        
        /* Custom Scrollbar for better aesthetics */
        ::-webkit-scrollbar { width: 8px; }
        ::-webkit-scrollbar-track { background: #f1f1f1; }
        ::-webkit-scrollbar-thumb { background: #CD212A; border-radius: 4px; } /* Red Scrollbar */
        ::-webkit-scrollbar-thumb:hover { background: #A51A22; }

        /* Chart Container Strict Styling */
        .chart-container {
            position: relative;
            width: 100%;
            max-width: 600px;
            margin-left: auto;
            margin-right: auto;
            height: 300px;
            max-height: 400px;
        }
        @media (min-width: 768px) {
            .chart-container {
                height: 350px;
            }
        }

        /* Base Social Button Styling */
        .social-btn {
            @apply flex items-center justify-center p-3 rounded-lg text-white transition-all duration-200 hover:scale-[1.05] shadow-md;
        }
        /* Specific styling for logo-only buttons */
        .social-logo-btn {
            @apply w-12 h-12 flex-none; /* Fixed size for clean logo display */
        }

        /* Quiz Specific Styles */
        .quiz-option {
            @apply w-full text-left p-3 mb-3 bg-white rounded-lg cursor-pointer transition-colors duration-200 shadow-sm hover:bg-gray-100 border-2 border-gray-100;
        }
        .quiz-option.selected {
            @apply ring-2 ring-offset-2 ring-[#CD212A] bg-red-50 border-[#CD212A];
        }

        /* Heartbeat Animation for CTA Buttons */
        @keyframes heartbeat {
            0%, 100% { transform: scale(1); }
            50% { transform: scale(1.05); box-shadow: 0 10px 15px -3px rgba(205, 33, 42, 0.4); }
        }
        .animate-heartbeat {
            animation: heartbeat 2s infinite ease-in-out;
        }
    </style>
    <!-- Chosen Palette: Italian Flag (Tricolore) -->
    <!-- Background: #F9FAFB (Cool White/Gray) -->
    <!-- Primary Green: #008C45 (Italian Flag Green) -->
    <!-- Accent Red: #CD212A (Italian Flag Red) -->
</head>
<body class="bg-[#F9FAFB] text-gray-800 h-screen overflow-hidden flex flex-col md:flex-row">

    <!-- Mobile Header -->
    <header class="md:hidden bg-[#008C45] text-white p-4 flex justify-between items-center z-20 shadow-md">
        <h1 class="text-xl font-bold">üáÆüáπ L√©xico Italiano</h1>
        <button id="mobile-menu-btn" class="animate-heartbeat bg-[#CD212A] hover:bg-[#A51A22] text-white px-4 py-2 rounded-lg font-bold shadow-md transition-all active:scale-95 flex items-center gap-2">
            EMPEZAR
        </button>
    </header>

    <!-- Sidebar Navigation -->
    <nav id="sidebar" class="transform -translate-x-full md:translate-x-0 transition-transform duration-300 fixed md:relative z-10 w-64 h-full bg-[#008C45] text-white flex flex-col shadow-xl">
        <div class="p-6 border-b border-white/20 hidden md:block">
            <h1 class="text-2xl font-bold tracking-wide">üáÆüáπ Italiano<br><span class="text-sm font-normal text-gray-100">para el D√≠a a D√≠a</span></h1>
        </div>
        
        <div class="px-6 pt-6 pb-2">
            <!-- Red CTA Button with Heartbeat Animation -->
            <button onclick="app.navigate('saludos')" class="animate-heartbeat w-full bg-[#CD212A] hover:bg-[#A51A22] text-white font-bold py-3 px-4 rounded-lg shadow-lg transition-all transform hover:scale-105 flex items-center justify-center gap-2 border border-red-800">
                <span>üöÄ</span> ¬°Empecemos!
            </button>
        </div>

        <div class="flex-1 overflow-y-auto py-4">
            <ul class="space-y-1">
                <!-- Nav items with Red border on active -->
                <li><button onclick="app.navigate('home')" class="nav-item w-full text-left px-6 py-3 hover:bg-[#007038] transition-colors bg-[#007038] font-semibold border-l-4 border-[#CD212A]" data-target="home">üè† Inicio / Dashboard</button></li>
                <li><button onclick="app.navigate('saludos')" class="nav-item w-full text-left px-6 py-3 hover:bg-[#007038] transition-colors border-l-4 border-transparent" data-target="saludos">üëã Saludos y B√°sicos</button></li>
                <li><button onclick="app.navigate('presentacion')" class="nav-item w-full text-left px-6 py-3 hover:bg-[#007038] transition-colors border-l-4 border-transparent" data-target="presentacion">ü§ù Presentaciones</button></li>
                <li><button onclick="app.navigate('numeros')" class="nav-item w-full text-left px-6 py-3 hover:bg-[#007038] transition-colors border-l-4 border-transparent" data-target="numeros">üî¢ N√∫meros (1-10)</button></li>
                <li><button onclick="app.navigate('colores')" class="nav-item w-full text-left px-6 py-3 hover:bg-[#007038] transition-colors border-l-4 border-transparent" data-target="colores">üé® Colores</button></li>
                <li><button onclick="app.navigate('animales')" class="nav-item w-full text-left px-6 py-3 hover:bg-[#007038] transition-colors border-l-4 border-transparent" data-target="animales">üê∂ Animales y Casa</button></li>
                <li><button onclick="app.navigate('viajes')" class="nav-item w-full text-left px-6 py-3 hover:bg-[#007038] transition-colors border-l-4 border-transparent" data-target="viajes">‚úàÔ∏è Viajes y Salud</button></li>
                <li><button onclick="app.navigate('clima')" class="nav-item w-full text-left px-6 py-3 hover:bg-[#007038] transition-colors border-l-4 border-transparent" data-target="clima">‚òÄÔ∏è Clima y Tiempo</button></li>
                <li><button onclick="app.navigate('quiz')" class="nav-item w-full text-left px-6 py-3 hover:bg-[#007038] transition-colors border-l-4 border-transparent" data-target="quiz">üß† Test de Vocabulario</button></li>
            </ul>
        </div>

        <div class="p-6 bg-[#006030] mt-auto border-t border-white/10">
            <p class="text-xs text-gray-200 mb-2">Progreso de sesi√≥n</p>
            <div class="w-full bg-[#004d26] rounded-full h-2.5 border border-white/10">
                <div id="progress-bar" class="bg-[#F4F4F4] h-2.5 rounded-full" style="width: 0%"></div> <!-- White bar on dark green -->
            </div>
            <p class="text-xs text-center mt-2 text-gray-200" id="progress-text">0/7 Temas explorados</p>
        </div>
    </nav>
    <!-- End Sidebar Navigation -->

    <!-- Main Content Area -->
    <main class="flex-1 overflow-y-auto relative p-4 md:p-8" id="main-content">
        
        <!-- View: Home / Dashboard -->
        <section id="view-home" class="max-w-4xl mx-auto animate-fade-in">
            <div class="mb-8 text-center md:text-left">
                <h2 class="text-3xl font-bold text-[#008C45] mb-2">Benvenuto! Bienvenido.</h2>
                <p class="text-gray-600">Esta aplicaci√≥n interactiva est√° dise√±ada para ayudarte a dominar el vocabulario italiano esencial. Explora las categor√≠as en el men√∫ para comenzar.</p>
            </div>

            <div class="grid grid-cols-1 md:grid-cols-2 gap-6 mb-8">
                <!-- Info Card -->
                <div class="bg-white p-6 rounded-xl shadow-md border-t-4 border-[#CD212A]">
                    <h3 class="font-bold text-xl mb-4 text-[#008C45]">C√≥mo usar esta app</h3>
                    <ul class="space-y-3 text-sm text-gray-700">
                        <li class="flex items-start"><span class="mr-2 text-[#CD212A]">‚û§</span> <strong>Paso 1:</strong> Presiona el bot√≥n <strong class="text-[#CD212A]">"¬°Empecemos!"</strong> (o "EMPEZAR" en m√≥viles) para iniciar tu primera lecci√≥n.</li>
                        <li class="flex items-start"><span class="mr-2 text-[#CD212A]">‚û§</span> Navega por los temas usando el men√∫ lateral.</li>
                        <li class="flex items-start"><span class="mr-2 text-[#CD212A]">‚û§</span> <strong>Haz clic en las tarjetas</strong> para revelar la frase de ejemplo.</li>
                        <li class="flex items-start"><span class="mr-2 text-[#CD212A]">‚û§</span> Practica en voz alta usando la gu√≠a fon√©tica simplificada (ej. <em>[ch√°o]</em>).</li>
                        <li class="flex items-start font-bold text-[#CD212A]"><span class="mr-2 text-[#CD212A]">‚û§</span> ¬°Haz el **Test de Vocabulario** para saber tu nivel de italiano!</li>
                    </ul>
                </div>

                <!-- Visualization -->
                <div class="bg-white p-6 rounded-xl shadow-md flex flex-col items-center justify-center border-t-4 border-[#008C45]">
                    <h3 class="font-bold text-lg mb-2 text-[#008C45]">Composici√≥n del Vocabulario</h3>
                    <div class="chart-container">
                        <canvas id="contentChart"></canvas>
                    </div>
                </div>
            </div>

            <!-- Call to Action Banner -->
            <div class="bg-white rounded-xl p-6 text-center shadow-md border border-gray-200">
                <h3 class="text-[#008C45] font-bold text-lg mb-2">¬°√önete a la Comunidad y Sigue Aprendiendo!</h3>
                <p class="text-sm text-gray-600 mb-6">S√≠guenos en redes para m√°s tips y contenido gratuito, o empieza tu curso digital ahora.</p>
                
                <div class="flex flex-wrap justify-center gap-6 mb-4">
                    <div class="flex flex-col items-center">
                        <a href="https://www.instagram.com/lexigo2.0/" target="_blank" class="social-btn social-logo-btn bg-pink-600" onclick="return true;">
                            <span class="text-2xl">üì∑</span>
                        </a>
                        <span class="text-xs mt-1 font-semibold text-gray-700">Instagram</span>
                    </div>

                    <div class="flex flex-col items-center">
                        <a href="https://www.facebook.com/profile.php?id=61583705050960" target="_blank" class="social-btn social-logo-btn bg-blue-600" onclick="return true;">
                            <span class="text-2xl">üëç</span>
                        </a>
                        <span class="text-xs mt-1 font-semibold text-gray-700">Facebook</span>
                    </div>

                    <div class="flex flex-col items-center">
                        <a href="https://www.tiktok.com/@lexigo2.0" target="_blank" class="social-btn social-logo-btn bg-gray-800" onclick="return true;">
                            <span class="text-2xl">üéµ</span>
                        </a>
                        <span class="text-xs mt-1 font-semibold text-gray-700">TikTok</span>
                    </div>
                </div>

                <!-- Digital Course Button (Red for CTA) -->
                <a href="https://go.hotmart.com/U103170151V" target="_blank" class="social-btn bg-[#CD212A] w-full text-lg font-bold hover:bg-[#A51A22] mt-4" onclick="return true;">
                    <span class="text-xl mr-2">üìö</span>
                    Iniciar Curso Digital
                </a>
            </div>
        </section>

        <!-- View: Cards Template -->
        <section id="view-cards" class="hidden max-w-5xl mx-auto">
            <div class="mb-6 border-b border-gray-300 pb-4">
                <h2 id="section-title" class="text-3xl font-bold text-[#008C45]">T√≠tulo Secci√≥n</h2>
                <p id="section-desc" class="text-gray-600 mt-2">Descripci√≥n de la secci√≥n.</p>
            </div>
            
            <div id="cards-grid" class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-6">
                <!-- Cards injected here -->
            </div>
        </section>

        <!-- View: Quiz -->
        <section id="view-quiz" class="hidden max-w-2xl mx-auto p-4 bg-white rounded-xl shadow-lg border-t-4 border-[#008C45]">
            <h2 class="text-3xl font-bold text-[#008C45] mb-4 text-center">üß† Test de Vocabulario</h2>
            <div id="quiz-container">
                <!-- Quiz content injected here -->
            </div>
            <div class="flex justify-between items-center mt-6">
                <p id="quiz-status" class="text-sm font-semibold text-gray-600"></p>
                <button id="quiz-next-btn" class="hidden bg-[#008C45] text-white font-bold py-2 px-4 rounded-lg shadow-md hover:bg-[#007038] transition-colors">
                    Siguiente Pregunta
                </button>
            </div>
        </section>

    </main>

    <!-- Overlay for mobile menu -->
    <div id="overlay" class="fixed inset-0 bg-black opacity-50 z-0 hidden md:hidden"></div>

    <!-- JavaScript Logic -->
    <script>
        const data = {
            saludos: {
                title: "Saludos y Expresiones B√°sicas",
                desc: "Los saludos son la puerta de entrada a cualquier conversaci√≥n. 'Ciao' es informal, mientras que 'Buongiorno' y 'Buonasera' son formales.",
                items: [
                    { it: "Ciao", pron: "ch√°o", es: "Hola / Adi√≥s", context: "Informal y vers√°til", fraseIt: "Ciao, come stai?", fraseEs: "Hola, ¬øc√≥mo est√°s?", frasePron: "ch√°o, k√≥-me st√°i?" },
                    { it: "Buongiorno", pron: "buon-y√≥r-no", es: "Buenos d√≠as", context: "Formal (Ma√±ana/Mediod√≠a)", fraseIt: "Buongiorno, vorrei un caff√®.", fraseEs: "Buenos d√≠as, me gustar√≠a un caf√©.", frasePron: "buon-y√≥r-no, vo-r√©i un ka-f√©" },
                    { it: "Buonasera", pron: "buo-na-s√©-ra", es: "Buenas tardes/noches", context: "Formal (Tarde/Noche)", fraseIt: "Buonasera, ho una prenotazione.", fraseEs: "Buenas noches, tengo una reserva.", frasePron: "buo-na-s√©-ra, o √∫-na pre-no-ta-tsi√≥-ne" },
                    { it: "Buonanotte", pron: "buo-na-n√≥-te", es: "Buenas noches", context: "Despedida al dormir", fraseIt: "Buonanotte, dormi bene.", fraseEs: "Buenas noches, duerme bien.", frasePron: "buo-na-n√≥-te, d√≥r-mi b√©-ne" },
                    { it: "Grazie", pron: "gr√°-tsi-e", es: "Gracias", context: "Cortes√≠a fundamental", fraseIt: "Grazie mille per l'aiuto.", fraseEs: "Mil gracias por la ayuda.", frasePron: "gr√°-tsi-e m√≠l-le per l'ai-√∫-to" },
                    { it: "Per favore", pron: "per fa-v√≥-re", es: "Por favor", context: "Para pedir algo", fraseIt: "Un bicchiere d'acqua, per favore.", fraseEs: "Un vaso de agua, por favor.", frasePron: "un bi-ki√©-re d'√°k-kua, per fa-v√≥-re" },
                    { it: "Scusa", pron: "sk√∫-sa", es: "Disculpa", context: "Informal", fraseIt: "Scusa, dov'√® il bagno?", fraseEs: "Disculpa, ¬ø d√≥nde est√° el ba√±o?", frasePron: "sk√∫-sa, do-v√© il b√°-√±o?" },
                    { it: "Mi scusi", pron: "mi sk√∫-si", es: "Disculpe", context: "Formal", fraseIt: "Mi scusi, posso passare?", fraseEs: "Disculpe, ¬øpuedo pasar?", frasePron: "mi sk√∫-si, p√≥s-so pa-sa-re?" },
                    { it: "Come stai?", pron: "k√≥-me st√°i", es: "¬øC√≥mo est√°s?", context: "Pregunta com√∫n", fraseIt: "Sto bene, e tu?", fraseEs: "Estoy bien, ¬øy t√∫?", frasePron: "sto b√©-ne, e t√∫?" }
                ]
            },
            presentacion: {
                title: "Presentaciones Personales",
                desc: "Estructuras directas y amigables para presentarte. 'Piacere' es esencial al conocer a alguien nuevo.",
                items: [
                    { it: "Mi chiamo...", pron: "mi ki√°-mo", es: "Me llamo...", context: "Tu nombre", fraseIt: "Mi chiamo Marco e sono qui per lavoro.", fraseEs: "Me llamo Marco y estoy aqu√≠ por trabajo.", frasePron: "mi ki√°-mo m√°r-ko e s√≥-no ku√≠ per la-v√≥-ro" },
                    { it: "Sono di...", pron: "s√≥-no di", es: "Soy de...", context: "Tu origen", fraseIt: "Sono di Argentina, ma vivo a Milano.", fraseEs: "Soy de Argentina, pero vivo en Mil√°n.", frasePron: "s√≥-no di ar-yen-t√≠-na, ma v√≠-vo a mi-l√°-no" },
                    { it: "Vivo a...", pron: "v√≠-vo a", es: "Vivo en...", context: "Tu residencia", fraseIt: "Vivo a Roma da due anni.", fraseEs: "Vivo en Roma desde hace dos a√±os.", frasePron: "v√≠-vo a r√≥-ma da d√∫-e √°n-ni" },
                    { it: "Ho ... anni", pron: "o ... √°n-ni", es: "Tengo ... a√±os", context: "Tu edad", fraseIt: "Ho trenta anni e un lavoro interessante.", fraseEs: "Tengo treinta a√±os y un trabajo interesante.", frasePron: "o tr√©n-ta √°n-ni e un la-v√≥-ro in-te-res-s√°n-te" },
                    { it: "Piacere", pron: "pia-ch√©-re", es: "Mucho gusto", context: "Saludo inicial", fraseIt: "Piacere di conoscerti finalmente.", fraseEs: "Encantado de conocerte finalmente.", frasePron: "pia-ch√©-re di ko-n√≥-sher-ti fi-nal-m√©n-te" },
                    { it: "Di dove sei?", pron: "di d√≥-ve s√©i", es: "¬øDe d√≥nde eres?", context: "Pregunta", fraseIt: "Sei qui per vacanza? Di dove sei?", fraseEs: "¬øEst√°s aqu√≠ de vacaciones? ¬øDe d√≥nde eres?", frasePron: "s√©i ku√≠ per va-k√°n-tsa? di d√≥-ve s√©i?" }
                ]
            },
            numeros: {
                title: "N√∫meros (1-10)",
                desc: "Esenciales para precios, horas y cantidades. Nota el sonido 'ch' en 'cinque' y 'dieci'.",
                items: [
                    { it: "Uno", pron: "√∫-no", es: "Uno", context: "Para contar", fraseIt: "Vorrei un biglietto, per favore.", fraseEs: "Quisiera un billete, por favor.", frasePron: "vo-r√©i un bi-y√©t-to, per fa-v√≥-re" },
                    { it: "Due", pron: "d√∫-e", es: "Dos", context: "Para contar", fraseIt: "Un tavolo per due persone.", fraseEs: "Una mesa para dos personas.", frasePron: "un t√°-vo-lo per d√∫-e per-s√≥-ne" },
                    { it: "Tre", pron: "tr√©", es: "Tres", context: "Para contar", fraseIt: "La stazione √® a tre chilometri.", fraseEs: "La estaci√≥n est√° a tres kil√≥metros.", frasePron: "la sta-tsi√≥-ne e a tr√© ki-l√≥-me-tri" },
                    { it: "Quattro", pron: "ku√°-tro", es: "Cuatro", context: "Para contar", fraseIt: "Sono le quattro del pomeriggio.", fraseEs: "Son las cuatro de la tarde.", frasePron: "s√≥-no le ku√°-tro del po-me-r√≠-yo" },
                    { it: "Cinque", pron: "ch√≠n-kue", es: "Cinco", context: "Sonido 'ch' suave", fraseIt: "Il mio numero √® il cinque.", fraseEs: "Mi n√∫mero es el cinco.", frasePron: "il m√≠o n√∫-me-ro e il ch√≠n-kue" },
                    { it: "Sei", pron: "s√©i", es: "Seis", context: "Para contar", fraseIt: "Ci vediamo alle sei.", fraseEs: "Nos vemos a las seis.", frasePron: "chi ve-di√°-mo √°l-le s√©i" },
                    { it: "Sette", pron: "s√©-te", es: "Siete", context: "Para contar", fraseIt: "Siamo un gruppo di sette amici.", fraseEs: "Somos un grupo de siete amigos.", frasePron: "si√°-mo un gr√∫p-po di s√©t-te a-m√≠-chi" },
                    { it: "Otto", pron: "√≥-to", es: "Ocho", context: "Para contar", fraseIt: "Il treno parte alle otto e mezza.", fraseEs: "El tren sale a las ocho y media.", frasePron: "il tr√©-no p√°r-te √°l-le √≥t-to e m√©-tsa" },
                    { it: "Nove", pron: "n√≥-ve", es: "Nueve", context: "Para contar", fraseIt: "Questo costa nove euro.", fraseEs: "Esto cuesta nueve euros.", frasePron: "ku√©s-to c√≥s-ta n√≥-ve √©u-ro" },
                    { it: "Dieci", pron: "di√©-chi", es: "Diez", context: "Para contar", fraseIt: "Pago dieci euro in contanti.", fraseEs: "Pago diez euros en efectivo.", frasePron: "p√°-go di√©-chi √©u-ro in kon-t√°n-ti" }
                ]
            },
            colores: {
                title: "Colores Esenciales",
                desc: "Para describir objetos y entornos. Muchos se parecen al espa√±ol.",
                items: [
                    { it: "Rosso", pron: "r√≥-so", es: "Rojo", context: "Mi maglia √® rossa.", color: "#EF4444", text: "white", fraseIt: "Il semaforo √® rosso, ferma la macchina.", fraseEs: "El sem√°foro est√° rojo, para el coche.", frasePron: "il se-m√°-fo-ro e r√≥s-so, f√©r-ma la m√°k-ki-na" },
                    { it: "Verde", pron: "v√©r-de", es: "Verde", context: "L'erba √® verde.", color: "#22C55E", text: "white", fraseIt: "Il colore della bandiera italiana √® verde.", fraseEs: "El color de la bandera italiana es verde.", frasePron: "il ko-l√≥-re d√©l-la ban-di√©-ra i-ta-li√°-na e v√©r-de" },
                    { it: "Giallo", pron: "y√°-lo", es: "Amarillo", context: "La luce del sole √® gialla.", color: "#FACC15", text: "black", fraseIt: "Voglio comprare una giacca gialla.", fraseEs: "Quiero comprar una chaqueta amarilla.", frasePron: "v√≥-√±o kom-pr√°-re √∫-na y√°k-ka y√°l-la" },
                    { it: "Nero", pron: "n√©-ro", es: "Negro", context: "Il cielo √® nero di notte.", color: "#000000", text: "white", fraseIt: "Ho un vestito elegante nero.", fraseEs: "Tengo un vestido negro elegante.", frasePron: "o un ves-t√≠-to e-le-g√°n-te n√©-ro" },
                    { it: "Bianco", pron: "bi√°n-ko", es: "Blanco", context: "La neve √® bianca.", color: "#FFFFFF", text: "black", border: true, fraseIt: "Preferisco le pareti bianche per la luce.", fraseEs: "Prefiero las paredes blancas por la luz.", frasePron: "pre-fe-r√≠s-ko le pa-r√©-ti bi√°n-ke per la l√∫-che" },
                    { it: "Blu", pron: "blu", es: "Azul", context: "Il cielo √® blu.", color: "#3B82F6", text: "white", fraseIt: "Il mio colore preferito √® il blu scuro.", fraseEs: "Mi color favorito es el azul oscuro.", frasePron: "il m√≠o ko-l√≥-re pre-fe-r√≠-to e il blu sk√∫-ro" }
                ]
            },
            animales: {
                title: "Animales y Objetos del Hogar",
                desc: "Vocabulario para describir tu entorno cotidiano.",
                items: [
                    { it: "Cane", pron: "k√°-ne", es: "Perro", context: "Animal", icon: "üêï", fraseIt: "Il cane del mio vicino abbaia forte.", fraseEs: "El perro de mi vecino ladra fuerte.", frasePron: "il k√°-ne del m√≠o vi-ch√≠-no ab-b√°i-a f√≥r-te" },
                    { it: "Gatto", pron: "g√°-to", es: "Gato", context: "Animal", icon: "üêà", fraseIt: "Il gatto dorme sempre sul letto.", fraseEs: "El gato duerme siempre en la cama.", frasePron: "il g√°-to d√≥r-me s√©m-pre sul l√©t-to" },
                    { it: "Uccello", pron: "uch√©-lo", es: "P√°jaro", context: "Animal", icon: "üê¶", fraseIt: "C'√® un uccello che canta sulla finestra.", fraseEs: "Hay un p√°jaro que canta en la ventana.", frasePron: "che un u-ch√©-lo ke kan-ta s√∫l-la fi-n√©s-tra" },
                    { it: "Pesce", pron: "p√©-she", es: "Pez", context: "Animal", icon: "üêü", fraseIt: "Vorrei un pesce fresco per cena.", fraseEs: "Quisiera un pescado fresco para cenar.", frasePron: "vo-r√©i un p√©-she fr√©s-ko per ch√©-na" },
                    { it: "Tavolo", pron: "t√°-vo-lo", es: "Mesa", context: "Hogar", icon: "ü™ë", fraseIt: "Lascia le chiavi sul tavolo.", fraseEs: "Deja las llaves sobre la mesa.", frasePron: "l√°-sha le ki√°-vi sul t√°-vo-lo" },
                    { it: "Letto", pron: "l√©t-to", es: "Cama", context: "Hogar", icon: "üõèÔ∏è", fraseIt: "Devo rifare il letto prima di uscire.", fraseEs: "Debo hacer la cama antes de salir.", frasePron: "d√©-vo ri-f√°-re il l√©t-to pr√≠-ma di u-sh√≠-re" },
                    { it: "Finestra", pron: "fi-n√©s-tra", es: "Ventana", context: "Hogar", icon: "ü™ü", fraseIt: "Per favore, apri la finestra, fa caldo.", fraseEs: "Por favor, abre la ventana, hace calor.", frasePron: "per fa-v√≥-re, √°-pri la fi-n√©s-tra, fa k√°l-do" },
                    { it: "Porta", pron: "p√≥r-ta", es: "Puerta", context: "Hogar", icon: "üö™", fraseIt: "La porta d'ingresso √® chiusa a chiave.", fraseEs: "La puerta de entrada est√° cerrada con llave.", frasePron: "la p√≥r-ta d'in-gr√©s-so e ki√∫-sa a ki√°-ve" }
                ]
            },
            viajes: {
                title: "Viajes y Salud",
                desc: "Frases cr√≠ticas para el aeropuerto y emergencias m√©dicas.",
                items: [
                    { it: "Passaporto", pron: "pasa-p√≥r-to", es: "Pasaporte", context: "Aeropuerto", fraseIt: "Dove devo mostrare il passaporto?", fraseEs: "¬øD√≥nde debo mostrar el pasaporte?", frasePron: "d√≥-ve d√©-vo mos-tr√°-re il pa-sa-p√≥r-to?" },
                    { it: "Uscita", pron: "u-sh√≠-ta", es: "Salida / Puerta", context: "Aeropuerto", fraseIt: "Qual √® l'uscita per il volo Roma?", fraseEs: "¬øCu√°l es la puerta para el vuelo a Roma?", frasePron: "kual e l'u-sh√≠-ta per il v√≥-lo r√≥-ma?" },
                    { it: "Bagaglio", pron: "ba-g√°-√±o", es: "Equipaje", context: "Aeropuerto", fraseIt: "Ho perso il mio bagaglio, dove devo andare?", fraseEs: "He perdido mi equipaje, ¬ø√≥nde debo ir?", frasePron: "o p√©r-so il m√≠o ba-g√°-√±o, d√≥-ve d√©-vo an-d√°-re?" },
                    { it: "Mi sento male", pron: "mi s√©n-to m√°-le", es: "Me siento mal", context: "Salud", fraseIt: "Mi sento male, ho bisogno di riposo.", fraseEs: "Me siento mal, necesito descansar.", frasePron: "mi s√©n-to m√°-le, o bi-z√≥-√±o di ri-p√≥-so" },
                    { it: "Ho bisogno di un dottore", pron: "o bi-z√≥-√±o di un dot-t√≥-re", es: "Necesito un doctor", context: "Emergencia", fraseIt: "Ho bisogno di un dottore urgentemente.", fraseEs: "Necesito un doctor urgentemente.", frasePron: "o bi-z√≥-√±o di un dot-t√≥-re ur-yen-te-m√©n-te" },
                    { it: "Aiuto", pron: "ai-√∫-to", es: "Ayuda", context: "Emergencia", fraseIt: "Aiuto! Chiama la polizia, per favore!", fraseEs: "¬°Ayuda! ¬°Llama a la polic√≠a, por favor!", frasePron: "ai-√∫-to! ki√°-ma la po-li-ts√≠-a, per fa-v√≥-re!" }
                ]
            },
            clima: {
                title: "Clima y el Tiempo",
                desc: "Expresiones meteorol√≥gicas y momentos del d√≠a.",
                items: [
                    { it: "Fa freddo", pron: "fa fr√©-do", es: "Hace fr√≠o", context: "Clima", icon: "‚ùÑÔ∏è", fraseIt: "Fa freddo oggi, devo mettere un cappotto.", fraseEs: "Hace fr√≠o hoy, tengo que ponerme un abrigo.", frasePron: "fa fr√©-do √≥d-yi, d√©-vo m√©t-te-re un kap-p√≥t-to" },
                    { it: "Fa caldo", pron: "fa c√°l-do", es: "Hace calor", context: "Clima", icon: "‚òÄÔ∏è", fraseIt: "Fa caldo! Andiamo al mare?", fraseEs: "¬°Hace calor! ¬øVamos al mar?", frasePron: "fa k√°l-do! an-di√°-mo al m√°-re?" },
                    { it: "Piove", pron: "pi√≥-ve", es: "Llueve", context: "Clima", icon: "üåßÔ∏è", fraseIt: "Non uscire, piove molto forte.", fraseEs: "No salgas, llueve muy fuerte.", frasePron: "non u-sh√≠-re, pi√≥-ve m√≥l-to f√≥r-te" },
                    { it: "Di mattina", pron: "di ma-t√≠-na", es: "Por la ma√±ana", context: "Tiempo", fraseIt: "La lezione inizia di mattina presto.", fraseEs: "La clase comienza por la ma√±ana temprano.", frasePron: "la le-tsi√≥-ne in-n√≠-tsia di ma-t√≠-na pr√©s-to" },
                    { it: "Di sera", pron: "di s√©-ra", es: "Por la noche", context: "Tiempo", fraseIt: "Ceniamo insieme di sera?", fraseEs: "¬øCenamos juntos por la noche?", frasePron: "che-ni√°-mo in-si√©-me di s√©-ra?" }
                ]
            }
        };

        function getQuizData() {
            const allVocab = [];
            for (const category in data) {
                if (category !== 'home') {
                    allVocab.push(...data[category].items);
                }
            }

            function shuffle(array) {
                let currentIndex = array.length, randomIndex;
                while (currentIndex != 0) {
                    randomIndex = Math.floor(Math.random() * currentIndex);
                    currentIndex--;
                    [array[currentIndex], array[randomIndex]] = [
                        array[randomIndex], array[currentIndex]];
                }
                return array;
            }

            const shuffledVocab = shuffle(allVocab);
            const quizItems = shuffledVocab.slice(0, 10); 

            const quizQuestions = quizItems.map(item => {
                const correct = item.es;
                let incorrectOptions = [];
                const pool = allVocab.filter(v => v.es !== correct);
                const shuffledPool = shuffle(pool);
                incorrectOptions = shuffledPool.slice(0, 2).map(v => v.es);

                let options = shuffle([...incorrectOptions, correct]);
                let questionText = `Traduce la palabra: "${item.it}"`;
                
                if (Math.random() < 0.5 && item.fraseIt && item.fraseEs) {
                     questionText = `Si alguien dice: "${item.fraseIt}", ¬øcu√°l es el significado m√°s cercano?`;
                     const correctPhrase = item.fraseEs;
                     let distractors = [];
                     distractors.push(item.es); 
                     const contextPool = allVocab.filter(v => v.fraseEs !== correctPhrase);
                     const randomDistractor = shuffle(contextPool).slice(0, 1)[0];
                     
                     if (randomDistractor && randomDistractor.fraseEs) {
                         distractors.push(randomDistractor.fraseEs);
                     } else {
                         distractors.push("No se entiende el contexto");
                     }
                     
                     let uniqueOptions = [...new Set([correctPhrase, ...distractors])].slice(0, 3);
                     while(uniqueOptions.length < 3) {
                        const filler = shuffle(allVocab.filter(v => !uniqueOptions.includes(v.es)))[0].es;
                        if(filler) uniqueOptions.push(filler);
                        else break;
                     }

                     return {
                        question: questionText,
                        correctAnswer: correctPhrase,
                        options: shuffle(uniqueOptions)
                     };

                }

                return {
                    question: questionText,
                    correctAnswer: correct,
                    options: options
                };
            });
            return quizQuestions;
        }

        const app = {
            currentView: 'home',
            visitedModules: new Set(),
            quiz: {
                data: [],
                currentQuestionIndex: 0,
                score: 0,
                questionAnswered: false,
            },
            
            init: function() {
                this.setupNavigation();
                this.renderChart();
                this.updateProgress();
            },

            setupNavigation: function() {
                const navBtn = document.getElementById('mobile-menu-btn');
                const sidebar = document.getElementById('sidebar');
                const overlay = document.getElementById('overlay');

                function toggleMenu() {
                    const isClosed = sidebar.classList.contains('-translate-x-full');
                    if (isClosed) {
                        sidebar.classList.remove('-translate-x-full');
                        overlay.classList.remove('hidden');
                    } else {
                        sidebar.classList.add('-translate-x-full');
                        overlay.classList.add('hidden');
                    }
                }

                navBtn.addEventListener('click', toggleMenu);
                overlay.addEventListener('click', toggleMenu);
            },

            navigate: function(target) {
                document.querySelectorAll('.nav-item').forEach(btn => {
                    if (btn.dataset.target === target) {
                        // Active State: Darker Green Background + Red Border
                        btn.classList.add('bg-[#007038]', 'border-[#CD212A]');
                        btn.classList.remove('border-transparent');
                    } else {
                        btn.classList.remove('bg-[#007038]', 'border-[#CD212A]');
                        btn.classList.add('border-transparent');
                    }
                });

                document.getElementById('view-home').classList.add('hidden');
                document.getElementById('view-cards').classList.add('hidden');
                document.getElementById('view-quiz').classList.add('hidden');
                
                if (target === 'home') {
                    document.getElementById('view-home').classList.remove('hidden');
                } else if (target === 'quiz') {
                    document.getElementById('view-quiz').classList.remove('hidden');
                    this.startQuiz();
                } else {
                    document.getElementById('view-cards').classList.remove('hidden');
                    this.renderCards(target);
                    this.visitedModules.add(target);
                    this.updateProgress();
                }

                const sidebar = document.getElementById('sidebar');
                if (window.innerWidth < 768 && !sidebar.classList.contains('-translate-x-full')) {
                    sidebar.classList.add('-translate-x-full');
                    document.getElementById('overlay').classList.add('hidden');
                }
            },

            renderCards: function(categoryKey) {
                const category = data[categoryKey];
                document.getElementById('section-title').textContent = category.title;
                document.getElementById('section-desc').textContent = category.desc;
                
                const grid = document.getElementById('cards-grid');
                grid.innerHTML = '';

                category.items.forEach(item => {
                    let cardBg = 'bg-white';
                    let textColor = 'text-[#008C45]'; // Green text by default
                    let borderColor = 'border-gray-200';
                    let iconHTML = item.icon ? `<div class="text-4xl mb-2">${item.icon}</div>` : '';
                    
                    if (item.color) {
                        cardBg = `style="background-color: ${item.color};"`;
                        textColor = item.text === 'white' ? 'text-white' : 'text-gray-900';
                        if (item.border) borderColor = 'border-gray-300';
                    }

                    const card = document.createElement('div');
                    card.onclick = function() {
                        this.querySelector('.relative').classList.toggle('group-hover:rotate-y-180');
                        this.querySelector('.relative').classList.toggle('rotate-y-180');
                    };

                    card.className = "group h-48 w-full cursor-pointer perspective-1000";
                    
                    card.innerHTML = `
                        <div class="relative h-full w-full text-center transition-transform duration-500 transform-style-3d shadow-lg rounded-xl border ${borderColor}">
                            
                            <!-- Front -->
                            <div class="absolute inset-0 flex flex-col items-center justify-center backface-hidden rounded-xl ${item.color ? '' : 'bg-white'}" ${item.color ? cardBg : ''}>
                                ${iconHTML}
                                <h3 class="text-2xl font-bold ${textColor}">${item.it}</h3>
                                <p class="text-sm font-semibold mt-1 ${item.color && item.text === 'white' ? 'text-white/80' : 'text-gray-600'}">${item.es}</p>
                                <p class="font-mono text-xs mt-1 text-[#CD212A] uppercase">[${item.pron}]</p>
                                
                                <div class="absolute bottom-2">
                                    <span class="bg-[#008C45] text-white text-xs px-3 py-1 rounded-full shadow-md">
                                        Ver Frase
                                    </span>
                                </div>
                                <div class="absolute bottom-3 right-3 text-gray-300">
                                    <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"></path></svg>
                                </div>
                            </div>

                            <!-- Back -->
                            <div class="absolute inset-0 flex flex-col items-center justify-center backface-hidden rotate-y-180 bg-[#008C45] text-white rounded-xl p-4">
                                <p class="text-xs uppercase tracking-widest text-green-100 mb-1">Frase de Ejemplo</p>
                                <p class="text-base italic mb-2 font-light text-center">"${item.fraseIt || item.context}"</p>
                                
                                <p class="font-mono text-xs mt-1 text-[#CD212A] bg-white px-2 py-0.5 rounded uppercase font-bold">[${item.frasePron || '...'}]</p>
                                
                                <p class="text-xs uppercase tracking-widest text-green-100 mt-2 mb-1">(Espa√±ol)</p>
                                <p class="text-sm font-semibold text-white text-center">"${item.fraseEs || item.context}"</p>
                            </div>
                        </div>
                    `;
                    grid.appendChild(card);
                });
            },

            updateProgress: function() {
                const total = 7;
                const current = this.visitedModules.size;
                const percent = Math.min(100, Math.round((current / total) * 100));
                
                document.getElementById('progress-bar').style.width = `${percent}%`;
                document.getElementById('progress-text').textContent = `${current}/${total} Temas explorados`;
            },
            
            startQuiz: function() {
                this.quiz.data = getQuizData();
                this.quiz.currentQuestionIndex = 0;
                this.quiz.score = 0;
                this.renderQuizQuestion();
            },

            renderQuizQuestion: function() {
                const container = document.getElementById('quiz-container');
                const status = document.getElementById('quiz-status');
                const question = this.quiz.data[this.quiz.currentQuestionIndex];

                if (!question) {
                    this.showQuizResults();
                    return;
                }
                
                this.quiz.questionAnswered = false;

                container.innerHTML = `
                    <p class="text-lg font-bold mb-4">Pregunta ${this.quiz.currentQuestionIndex + 1} de ${this.quiz.data.length}</p>
                    <p class="text-xl mb-6 font-semibold text-[#008C45]">${question.question}</p>
                    <div id="quiz-options-container" class="flex flex-col space-y-3">
                        ${question.options.map((option, index) => `
                            <button class="quiz-option" data-option="${option}" onclick="app.checkAndAdvance(this)">
                                ${option}
                            </button>
                        `).join('')}
                    </div>
                `;

                status.textContent = `Puntuaci√≥n actual: ${this.quiz.score}`;
            },

            checkAndAdvance: function(element) {
                if (this.quiz.questionAnswered) return;

                this.quiz.questionAnswered = true;
                const selectedAnswer = element.dataset.option;
                const currentQ = this.quiz.data[this.quiz.currentQuestionIndex];
                const isCorrect = selectedAnswer === currentQ.correctAnswer;
                
                if (isCorrect) {
                    this.quiz.score++;
                }

                document.querySelectorAll('#quiz-options-container .quiz-option').forEach(opt => {
                    opt.onclick = null;
                    opt.classList.remove('hover:bg-gray-100', 'bg-white');
                    
                    if (opt.dataset.option === currentQ.correctAnswer) {
                        opt.classList.add('bg-green-100', 'border-2', 'border-[#008C45]', 'shadow-lg');
                    } else if (opt.dataset.option === selectedAnswer) {
                        opt.classList.add('bg-red-100', 'border-2', 'border-[#CD212A]', 'shadow-lg');
                    } else {
                        opt.classList.add('bg-gray-50', 'opacity-50'); 
                    }
                });
                
                document.getElementById('quiz-status').textContent = `Puntuaci√≥n: ${this.quiz.score} (${isCorrect ? '¬°Correcto!' : 'Incorrecto'})`;

                setTimeout(() => {
                    this.quiz.currentQuestionIndex++;
                    this.renderQuizQuestion();
                }, 1000); 
            },

            showQuizResults: function() {
                const container = document.getElementById('quiz-container');
                const finalScore = this.quiz.score;
                const totalQuestions = this.quiz.data.length;
                const percentage = (finalScore / totalQuestions) * 100;
                
                let feedback = '';
                if (percentage >= 80) feedback = '¬°Bravissimo! Tienes un excelente dominio del vocabulario.';
                else if (percentage >= 50) feedback = '¬°Bene! Est√°s en el camino correcto.';
                else feedback = 'Sigue practicando, pronto lo lograr√°s.';

                container.innerHTML = `
                    <div class="text-center p-6">
                        <h3 class="text-3xl font-bold text-[#008C45] mb-4">Test Completado</h3>
                        <p class="text-2xl mb-4">Tu puntuaci√≥n final es:</p>
                        <p class="text-6xl font-extrabold text-[#CD212A]">${finalScore}/${totalQuestions}</p>
                        <p class="text-lg text-gray-700 mt-2">(${percentage.toFixed(0)}%)</p>
                        <p class="mt-6 text-xl text-gray-800 font-medium">${feedback}</p>
                        
                        <div class="mt-8 pt-6 border-t border-gray-200">
                            <h4 class="text-2xl font-bold text-[#008C45] mb-4">¬°Lleva tu italiano al siguiente nivel!</h4>
                            <a href="https://go.hotmart.com/U103170151V" target="_blank" class="block w-full text-center bg-[#CD212A] text-white font-bold py-3 px-6 rounded-lg shadow-xl hover:bg-[#A51A22] transition-colors text-xl">
                                üìö Iniciar Curso Digital
                            </a>
                        </div>
                        
                        <button onclick="app.startQuiz()" class="mt-4 bg-gray-400 text-white font-bold py-2 px-6 rounded-lg shadow-md hover:bg-gray-500 transition-colors">
                            Reiniciar Test
                        </button>
                    </div>
                `;
                document.getElementById('quiz-next-btn').style.display = 'none';
                document.getElementById('quiz-status').textContent = '';
            },

            renderChart: function() {
                const ctx = document.getElementById('contentChart').getContext('2d');
                
                const labels = Object.keys(data).map(k => data[k].title.split(' ')[0]);
                const counts = Object.keys(data).map(k => data[k].items.length);

                new Chart(ctx, {
                    type: 'doughnut',
                    data: {
                        labels: labels,
                        datasets: [{
                            data: counts,
                            backgroundColor: [
                                '#008C45', '#009955', '#33a36b', // Greens
                                '#CD212A', '#D93b44', '#E0555d', // Reds
                                '#A3A3A3' // Gray filler
                            ],
                            borderWidth: 0
                        }]
                    },
                    options: {
                        responsive: true,
                        maintainAspectRatio: false,
                        plugins: {
                            legend: {
                                position: 'right',
                                labels: {
                                    boxWidth: 12,
                                    font: { size: 10 }
                                }
                            }
                        }
                    }
                });
            }
        };

        document.addEventListener('DOMContentLoaded', () => {
            app.init();
        });

    </script>
</body>
</html>